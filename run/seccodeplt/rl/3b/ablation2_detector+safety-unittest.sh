export WANDB_API_KEY="YOUR_KEY_HERE"
export VLLM_ATTENTION_BACKEND=XFORMERS

PYTHONUNBUFFERED=1 python -m verl.trainer.main_ppo \
 data.train_files=./data/seccodeplt/train.parquet \
 data.val_files=./data/seccodeplt/test.parquet \
 data.train_batch_size=512 \
 data.val_batch_size=512 \
 data.max_prompt_length=375 \
 data.max_response_length=1024 \
 actor_rollout_ref.model.path=Qwen/Qwen2.5-Coder-3B-Instruct \
 actor_rollout_ref.actor.optim.lr=1e-6 \
 actor_rollout_ref.actor.ppo_mini_batch_size=64 \
 actor_rollout_ref.actor.ppo_micro_batch_size_per_gpu=2 \
 actor_rollout_ref.rollout.log_prob_micro_batch_size_per_gpu=2 \
 actor_rollout_ref.rollout.tensor_model_parallel_size=1 \
 actor_rollout_ref.rollout.gpu_memory_utilization=0.4 \
 actor_rollout_ref.ref.log_prob_micro_batch_size_per_gpu=2 \
 critic.optim.lr=1e-5 \
 critic.model.path=Qwen/Qwen2.5-Coder-3B-Instruct \
 critic.ppo_micro_batch_size_per_gpu=2 \
 algorithm.kl_ctrl.kl_coef=0.001 \
 trainer.logger=['console','wandb'] \
 +trainer.val_before_train=True \
 trainer.val_generations_to_log_to_wandb=5 \
 trainer.default_hdfs_dir=null \
 trainer.n_gpus_per_node=8 \
 trainer.nnodes=1 \
 trainer.save_freq=20 \
 trainer.test_freq=1 \
 trainer.project_name='SecCodeGen-contrast' \
 trainer.experiment_name='3b_exp2_scp_ppt-tsk_fv-sd0.0_ut-sc' \
 trainer.resume_from_path=True \
 trainer.total_epochs=140 \
 +safety_ratio=0.5 \
 +mypy_ratio=0.0 \
 +scpd_ratio=0.0 \
 +ut_ratio=1.0 \